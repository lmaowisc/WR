[{"path":"https://lmaowisc.github.io/WR/articles/PW_reg.html","id":"model-specification","dir":"Articles","previous_headings":"","what":"MODEL SPECIFICATION","title":"Proportional win-fractions (PW) regression of composite endpoints of death and nonfatal event","text":"Let DD denote survival time, TT time first nonfatal event like hospitalization, 𝐙\\boldsymbol Z pp-vector covariates. composite outcome 𝐘=(D,T)\\boldsymbol Y=(D, T) DD prioritized TT. iith jjth patients followed time tt, define 𝒲(𝐘i,𝐘j)(t)=(subject wins subject j t)=(Dj<Di∧t)+(Di∧Dj>t,Tj<Ti∧t),\\mathcal W(\\boldsymbol Y_i, \\boldsymbol Y_j)(t) = (\\mbox{subject $$ wins subject $j$ $t$}) = (D_j < D_i \\wedge t) + (D_i \\wedge D_j > t, T_j < T_i \\wedge t), ∧b=min(,b)\\wedge b=\\min(,b). ‘’win indicator’’ uses sequential comparison rule Pocock et al. (2012). , covariate-specific win ratio tt WR(t;𝐙i,𝐙j):=E{𝒲(𝐘i,𝐘j)(t)∣𝐙i,𝐙j}E{𝒲(𝐘j,𝐘i)(t)∣𝐙i,𝐙j}.WR(t;\\boldsymbol Z_i, \\boldsymbol Z_j):=\\frac{E\\{\\mathcal W(\\boldsymbol Y_i, \\boldsymbol Y_j)(t)\\mid \\boldsymbol Z_i, \\boldsymbol Z_j\\}}{E\\{\\mathcal W(\\boldsymbol Y_j, \\boldsymbol Y_i)(t)\\mid \\boldsymbol Z_i, \\boldsymbol Z_j\\}}. example, subject ii treatment arm 𝐙i=1\\boldsymbol Z_i=1 subject jj treatment arm 𝐙j=0\\boldsymbol Z_j=0, WR(t;𝐙i,𝐙j)WR(t;\\boldsymbol Z_i, \\boldsymbol Z_j) precisely estimand Pocock’s win ratio comparing treatment control subjects arms followed time tt. PW model specifies $$\\mbox{PW Model: }\\hspace{3mm} WR(t;\\boldsymbol Z_i, \\boldsymbol Z_j)=\\exp\\{\\boldsymbol\\beta^{\\rm T}(\\boldsymbol Z_i -\\boldsymbol Z_j)\\}.$$ Clearly, PW model assumes win ratio invariant follow-time (proportionality assumption). model, components 𝛃\\boldsymbol\\beta can interpreted log win ratios associated unit increases corresponding covariates. PW model, can obtain consistent estimates parameter 𝛃\\boldsymbol\\beta based censored data regardless distribution censoring time CC long (C⊥𝐘)∣𝐙.(C\\perp \\boldsymbol Y)\\mid \\boldsymbol Z.","code":""},{"path":"https://lmaowisc.github.io/WR/articles/PW_reg.html","id":"basic-syntax","dir":"Articles","previous_headings":"","what":"BASIC SYNTAX","title":"Proportional win-fractions (PW) regression of composite endpoints of death and nonfatal event","text":"input data must “long format”, ID vector containing unique patient-level identifiers. addition, need time vector containing event times status vector indicating corresponding cause event. vector status coded 1=death; 2=non-fatal event; 0=censoring. case recurrent non-fatal event, multiple rows status=2 allowed. However, nature method, time first episode used. Finally, need covariate matrix Z row ID. column Z represents covariate. covariates need time-constant. main function fit PW model pwreg(time,status, Z, ID). function returns object class pwreg beta vector 𝛃̂\\widehat{\\boldsymbol\\beta} Var matrix var(𝛃̂)\\text{var}(\\widehat{\\boldsymbol\\beta}). details, refer documentation WR package.","code":""},{"path":"https://lmaowisc.github.io/WR/articles/PW_reg.html","id":"an-example-with-the-hf-action-trial","dir":"Articles","previous_headings":"","what":"AN EXAMPLE WITH THE HF-ACTION TRIAL","title":"Proportional win-fractions (PW) regression of composite endpoints of death and nonfatal event","text":"consider dataset HF-ACTION study consisting 451 non-ischemic heart failure patients. study conducted April 2003 Feb 2007 82 sites USA, Canada, France (O’Connor et al., 2009). study objective assess effect adding aerobic exercise training usual care patient’s CV outcomes. primary endpoint composite -cause death -cause hospitalization. first load WR package analysis dataset non_ischemic. re-label covariates informative names. Compute sample size median length follow-. indeed n=451n=451 unique patients median follow-31.6 months. Next, use pwreg() function fit PW model: output consists three parts. first part presents descriptive statistics proportions win-loss status among (n2)=101,475{n\\choose 2}=101,475 pairs. According output, 7.5%7.5\\% determined death; 77.2%77.2\\% hospitalization, remaining 7.2%7.2\\% indeterminate. also reports overall (Wald) test pp-value 0.024, suggesting , conventional 0.05 level, 13 covariates significantly associated composite outcome. second part presents table estimates standard errors regression coefficient, along corresponding pp-value testing coefficient zero. third part perhaps informative, tabulating estimated win ratios (exponential regression coefficients) associated 95%95\\% confidence intervals. can see patient exercise training 21%21\\% likely better priority-adjusted composite outcome one usual care. However, difference statistically significant. addition, younger age, white race, higher LVEF significantly associated favorable outcomes otherwise, beneficial effects low BMI absence COPD history border-line significant. assess effect race composite outcome, test null hypothesis H0:β4=β5=0.H_0:\\beta_4=\\beta_5=0. conduct 2-df Chi-square Wald test based (β̂4,β̂5)T(\\widehat\\beta_4,\\widehat\\beta_5)^{T}: pp-value 0.102. overall effect race composite outcome non-significant. Finally, use score.proc() function plot standardized score process covariate:  curves fairly patternless suprema well bounded 2. conclude proportionality assumption approximately holds.","code":"library(WR) #> Error in get(paste0(generic, \".\", class), envir = get_method_env()) :  #>   object 'type_sum.accel' not found head(non_ischemic) #>   ID time status trt_ab age sex Black.vs.White Other.vs.White   bmi bipllvef #> 1  1  221      2      0  62   1              0              0 25.18    32.24 #> 2  1  383      0      0  62   1              0              0 25.18    32.24 #> 3  2   23      2      0  75   1              1              0 22.96    21.71 #> 4  2 1400      0      0  75   1              1              0 22.96    21.71 #> 5  5    7      2      0  48   1              1              0 34.37    22.97 #> 6  5   10      1      0  48   1              1              0 34.37    22.97 #>   hyperten COPD diabetes acei betab smokecurr #> 1        0    0        0    0     1         1 #> 2        0    0        0    0     1         1 #> 3        1    0        0    0     1         0 #> 4        1    0        0    0     1         0 #> 5        1    0        0    0     1         0 #> 6        1    0        0    0     1         0 colnames(non_ischemic)[4:16]=c(   \"Training vs Usual\",\"Age (year)\",\"Male vs Female\",\"Black vs White\",    \"Other vs White\", \"BMI\",\"LVEF\",\"Hypertension\",\"COPD\",\"Diabetes\",   \"ACE Inhibitor\",\"Beta Blocker\", \"Smoker\" ) # sample size length(unique(non_ischemic$ID)) #> [1] 451 # median length of follow-up time median(non_ischemic$time[non_ischemic$status<2])/30.5 #> [1] 31.63934 # get the number of rows and number of covariates. nr <- nrow(non_ischemic) p <- ncol(non_ischemic)-3  # extract ID, time, status and covariates matrix Z from the data. # note that: ID, time and status should be column vector. # covariatesZ should be (nr, p) matrix. ID <- non_ischemic[,\"ID\"] time <- non_ischemic[,\"time\"] status <- non_ischemic[,\"status\"] Z <- as.matrix(non_ischemic[,4:(3+p)],nr,p)   # pass the parameters into the function pwreg.obj <- pwreg(time=time,status=status,Z=Z,ID=ID) print(pwreg.obj) #> Call: #> pwreg(ID = ID, time = time, status = status, Z = Z) #>  #> Proportional win-fractions regression models for priority-adjusted composite endpoint #>  #>     (Mao and Wang, 2020): #>  #> Total number of pairs: 101475  #> Wins-losses on death:  7644 (7.5%)  #> Wins-losses on non-fatal event:  78387 (77.2%)  #> Indeterminate pairs 15444 (15.2%)  #>  #> Newton-Raphson algorithm converged in 5 iterations. #>  #> Overall test: chisq test with 13 degrees of freedom;  #>  Wald statistic 24.9 with p-value 0.02392931  #>  #> Estimates for Regression parameters: #>                     Estimate         se z.value p.value   #> Training vs Usual  0.1906687  0.1264658  1.5077 0.13164   #> Age (year)        -0.0128306  0.0057285 -2.2398 0.02510 * #> Male vs Female    -0.1552923  0.1294198 -1.1999 0.23017   #> Black vs White    -0.3026335  0.1461330 -2.0709 0.03836 * #> Other vs White    -0.3565390  0.3424360 -1.0412 0.29779   #> BMI               -0.0181310  0.0097582 -1.8580 0.06316 . #> LVEF               0.0214905  0.0086449  2.4859 0.01292 * #> Hypertension      -0.0318291  0.1456217 -0.2186 0.82698   #> COPD              -0.4023069  0.2066821 -1.9465 0.05159 . #> Diabetes           0.0703990  0.1419998  0.4958 0.62006   #> ACE Inhibitor     -0.1068201  0.1571317 -0.6798 0.49662   #> Beta Blocker      -0.5344979  0.3289319 -1.6250 0.10417   #> Smoker            -0.0602350  0.1682826 -0.3579 0.72039   #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 #>  #>  #> Point and interval estimates for the win ratios: #>                   Win Ratio 95% lower CL 95% higher CL #> Training vs Usual 1.2100585    0.9444056     1.5504374 #> Age (year)        0.9872513    0.9762288     0.9983983 #> Male vs Female    0.8561648    0.6643471     1.1033663 #> Black vs White    0.7388699    0.5548548     0.9839127 #> Other vs White    0.7000951    0.3578286     1.3697431 #> BMI               0.9820323    0.9634287     1.0009952 #> LVEF              1.0217231    1.0045572     1.0391823 #> Hypertension      0.9686721    0.7281543     1.2886357 #> COPD              0.6687755    0.4460178     1.0027865 #> Diabetes          1.0729362    0.8122757     1.4172433 #> ACE Inhibitor     0.8986873    0.6604773     1.2228110 #> Beta Blocker      0.5859634    0.3075270     1.1164977 #> Smoker            0.9415433    0.6770144     1.3094312 #extract estimates of (\\beta_4,\\beta_5) beta <- matrix(pwreg.obj$beta[4:5]) #extract estimated covariance matrix for (\\beta_4,\\beta_5) Sigma <- pwreg.obj$Var[4:5,4:5] #compute chisq statistic in quadratic form chistats <- t(beta) %*% solve(Sigma) %*% beta    #compare the Wald statistic with the reference # distribution of chisq(2) to obtain the p-value 1 - pchisq(chistats, df=2) #>           [,1] #> [1,] 0.1016988 score.obj <- score.proc(pwreg.obj) print(score.obj) #> This object contains two components: #>  't': an l-vector of times #>  'score': a p-by-l matrix whose k'th row is the standardized score process for the k'th covariate #>           as a function of t #>  #> Use 'plot(object,k=k)' to plot the k'th score process.  oldpar <- par(mfrow = par(\"mfrow\")) par(mfrow = c(4,4)) for(i in c(1:13)){   plot(score.obj, k = i) } par(oldpar)"},{"path":"https://lmaowisc.github.io/WR/articles/PW_reg.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Proportional win-fractions (PW) regression of composite endpoints of death and nonfatal event","text":"Mao, L. Wang, T. (2020). class proportional win-fractions regression models composite outcomes. Biometrics, https://doi.org/10.1111/biom.13382. O’Connor, C. M., Whellan, D. J., Lee, K. L., Keteyian, S. J., Cooper, L. S., Ellis, S. J., Leifer, E. S., Kraus, W. E., Kitzman, D. W., Blumenthal, J. . et al. (2009). Efficacy safety exercise training patients chronic heart failure: HF-ACTION randomized controlled trial. Journal American Medical Association, 301, 1439–1450. Pocock, S., Ariti, C., Collier, T., Wang, D. (2012). win ratio: new approach analysis composite endpoints clinical trials based clinical priorities. European Heart Journal, 33, 176–182.","code":""},{"path":[]},{"path":"https://lmaowisc.github.io/WR/articles/PW_stratify_reg.html","id":"outcome-data-and-modeling-target","dir":"Articles","previous_headings":"MODEL & INFERENCE","what":"Outcome data and modeling target","title":"Stratified proportional win-fractions (PW) regression of composite endpoints of death and nonfatal event","text":"Let DD denote survival time, TT time first nonfatal event like hospitalization, 𝐙\\boldsymbol Z pp-vector covariates. composite outcome 𝐘=(D,T)\\boldsymbol Y=(D, T), DD prioritized TT. Suppose LL strata defined , e.g., patient demographics study center. llth stratum (l=1,…,L)(l=1,\\ldots, L), want compare iith jjth patients, denoted respectively using subscripts lili ljlj, can use Pocock et al.’s (2012) sequential rule “win indicator” defined 𝒲(𝐘li,𝐘lj)(t)=(subject wins subject j t stratum l)=(Dlj<Dli∧t)+(Dli∧Dlj>t,Tlj<Tli∧t),\\begin{align*} \\mathcal W(\\boldsymbol Y_{li}, \\boldsymbol Y_{lj})(t)  & = (\\mbox{subject $$ wins subject $j$ $t$ stratum $l$})\\\\  & = (D_{lj} < D_{li} \\wedge t) + (D_{li} \\wedge D_{lj} > t, T_{lj} < T_{li} \\wedge t), \\end{align*} ∧b=min(,b)\\wedge b=\\min(,b). , (time-dependent) covariate-specific win ratio llth stratum ℛl(t;𝐙li,𝐙lj):=E{𝒲(𝐘li,𝐘lj)(t)∣𝐙li,𝐙lj}E{𝒲(𝐘lj,𝐘li)(t)∣𝐙li,𝐙lj}.\\mathcal R_l(t;\\boldsymbol Z_{li}, \\boldsymbol Z_{lj}):= \\frac{E\\{\\mathcal W(\\boldsymbol Y_{li}, \\boldsymbol Y_{lj})(t)\\mid \\boldsymbol Z_{li}, \\boldsymbol Z_{lj}\\}}{E\\{\\mathcal W(\\boldsymbol Y_{lj}, \\boldsymbol Y_{li})(t)\\mid \\boldsymbol Z_{li}, \\boldsymbol Z_{lj}\\}}.","code":""},{"path":"https://lmaowisc.github.io/WR/articles/PW_stratify_reg.html","id":"model-specification","dir":"Articles","previous_headings":"MODEL & INFERENCE","what":"Model specification","title":"Stratified proportional win-fractions (PW) regression of composite endpoints of death and nonfatal event","text":"stratified PW model specifies $$\\begin{equation}\\tag{1} \\mbox{Stratified PW:}\\hspace{3mm} \\mathcal R_l(t;\\boldsymbol Z_{li}, \\boldsymbol Z_{lj})=\\exp\\{\\boldsymbol\\beta^{\\rm T}(\\boldsymbol Z_{li} -\\boldsymbol Z_{lj})\\},\\hspace{3mm} l=1,\\ldots, L. \\end{equation}$$ , assume covariate-specific win ratio stratum invariant follow-time (proportionality win fractions) depends common regression parameter 𝛃\\boldsymbol\\beta. model (1), components 𝛃\\boldsymbol\\beta can interpreted log-win ratios associated unit increases corresponding covariates within stratum. model (1) involves within-stratum comparisons, require proportionality hold across strata unstratified PW model .","code":""},{"path":"https://lmaowisc.github.io/WR/articles/PW_stratify_reg.html","id":"number-of-strata-and-inference-procedure","dir":"Articles","previous_headings":"MODEL & INFERENCE","what":"Number of strata and inference procedure","title":"Stratified proportional win-fractions (PW) regression of composite endpoints of death and nonfatal event","text":"(1), can obtain consistent estimates parameter 𝛃\\boldsymbol\\beta based censored data independent censoring assumption (Cli⊥𝐘li)∣𝐙li.(C_{li}\\perp \\boldsymbol Y_{li})\\mid \\boldsymbol Z_{li}. every l=1,…,Ll=1,\\ldots, L. two approaches estimating variance resulting estimator 𝛃\\boldsymbol\\beta, appropriate different context. number strata LL small, case sex race categories, can apply variance estimator unstratified PW model stratum sum stratum-specific variances. call type variance estimator. LL large, case matched pairs (L=n/2L=n/2), stratum need contain enough subjects support variance estimator. instead treat strata basic units observation take Lindeberg–Feller-type approach quantifying variance sum independent (necessarily identically distributed) units. gives us type II variance estimator.","code":""},{"path":"https://lmaowisc.github.io/WR/articles/PW_stratify_reg.html","id":"basic-syntax","dir":"Articles","previous_headings":"","what":"BASIC SYNTAX","title":"Stratified proportional win-fractions (PW) regression of composite endpoints of death and nonfatal event","text":"input data must “long format”, ID vector containing unique patient-level identifiers. addition, need time vector containing event times status vector indicating corresponding cause event. vector status coded 1=death; 2=non-fatal event; 0=censoring. case recurrent non-fatal events, multiple rows status=2 allowed. However, nature method, time first episode used. Finally, need covariate matrix Z row ID. column Z represents covariate. covariates need time-constant. main function fit stratified PW model ID, time, status, Z specified . optional argument strata accepts (categorical) stratifying variable. default option fixedL=TRUE requests type variance estimator (small LL) fixedL=FALSE requests type II variance estimator (large LL). function returns object class pwreg beta vector 𝛃̂\\widehat{\\boldsymbol\\beta} Var matrix var(𝛃̂)\\text{var}(\\widehat{\\boldsymbol\\beta}). Score processes check proportionality assumption can computed plotted rule thumb, consider proportionality tenable score processes bounded [−2,2][-2, 2].","code":"obj<-pwreg(ID, time, status, Z, strata, fixedL=TRUE) ## compute the standardized score processes score<-score.proc(obj) ## plot the computed process for the kth covariate plot(score, k)"},{"path":"https://lmaowisc.github.io/WR/articles/PW_stratify_reg.html","id":"an-example-with-the-german-breast-cancer-study","dir":"Articles","previous_headings":"","what":"AN EXAMPLE WITH THE GERMAN BREAST CANCER STUDY","title":"Stratified proportional win-fractions (PW) regression of composite endpoints of death and nonfatal event","text":"demonstrate stratified PW regression methods using subset data German Breast Cancer study consisting 686 patients primary node positive breast cancer (Sauerbrei et al., 1999).","code":""},{"path":"https://lmaowisc.github.io/WR/articles/PW_stratify_reg.html","id":"data-preparation","dir":"Articles","previous_headings":"AN EXAMPLE WITH THE GERMAN BREAST CANCER STUDY","what":"Data preparation","title":"Stratified proportional win-fractions (PW) regression of composite endpoints of death and nonfatal event","text":"study conducted July 1984 December 1989 assess effectiveness hormonal treatment tamoxifen addition standard chemotherapy reducing cancer relapse (nonfatal event) mortality patients. first load WR package analysis dataset gbc. Covariates include: hormone: Treatment indicator: 1=Hormone therapy; 2=standard therapy; age Age diagnosis (years) menopause Menopausal Status; 1=; 2=Yes grade Tumor grade, 1-3 nodes Number nodes involved prog_recp Number progesterone receptors estrg_recp Number estrogen receptors grade column gbc factor variable. create dummy variables grade.","code":"library(WR) #> Error in get(paste0(generic, \".\", class), envir = get_method_env()) :  #>   object 'type_sum.accel' not found head(gbc) #>   id     time status hormone age menopause size grade nodes prog_recp #> 1  1 43.83607      2       1  38         1   18     3     5       141 #> 2  1 74.81967      0       1  38         1   18     3     5       141 #> 3  2 46.55738      2       1  52         1   20     1     1        78 #> 4  2 65.77049      0       1  52         1   20     1     1        78 #> 5  3 41.93443      2       1  47         1   30     2     1       422 #> 6  3 47.73770      1       1  47         1   30     2     1       422 #>   estrg_recp #> 1        105 #> 2        105 #> 3         14 #> 4         14 #> 5         89 #> 6         89 grade_matrix <- model.matrix(~factor(grade),data=gbc) grade_df <- as.data.frame(grade_matrix[,-1]) names(grade_df) <- c(\"grade2 vs grade1\", \"grade3 vs grade1\") gbc <- cbind.data.frame(gbc[,-8], grade_df)"},{"path":"https://lmaowisc.github.io/WR/articles/PW_stratify_reg.html","id":"stratification-by-menopause-status","dir":"Articles","previous_headings":"AN EXAMPLE WITH THE GERMAN BREAST CANCER STUDY","what":"Stratification by menopause status","title":"Stratified proportional win-fractions (PW) regression of composite endpoints of death and nonfatal event","text":"Next, fit PW model stratified menopause status. stratifying variable two levels, use type variance estimator. can see , adjusting variables stratifying menopause status, hormonal treatment makes patient 1.5 times likely favorable outcome (prioritizing survival cancer relapse), 95% confidence interval (1.2, 2.0) pp-value 0.003. Next, plot standardized score process covariate: curves bounded -2 2, suggesting severe violation proportionality assumption.","code":"## extract the covariate matrix Z from the data ## leaving out menopause as the stratifying variable Z1 <- as.matrix(gbc[,c(\"hormone\", \"age\", \"size\", \"nodes\", \"prog_recp\",                        \"estrg_recp\", \"grade2 vs grade1\", \"grade3 vs grade1\")])  ## fit a PW model stratified by the binary menopause status ## use type I variance estimator obj1<-pwreg(ID=gbc$id,time=gbc$time,status=gbc$status, Z=Z1,strata=gbc$menopause,fixedL=TRUE) ## print out the results print(obj1) #> Call: #> pwreg(ID = gbc$id, time = gbc$time, status = gbc$status, Z = Z1,  #>     strata = gbc$menopause, fixedL = TRUE) #>  #> Stratified proportional win-fractions regression analysis #>  #>     (Wang and Mao, 2021+): #>  #> Total number of strata: 2  #> Newton-Raphson algorithm converged in 6 iterations. #>  #> Overall test: chisq test with 8 degrees of freedom;  #>  Wald statistic 96 with p-value 0  #>  #> Estimates for Regression parameters: #>                     Estimate          se z.value   p.value     #> hormone           4.2232e-01  1.4207e-01  2.9726  0.002953 **  #> age               1.2849e-02  9.9410e-03  1.2925  0.196175     #> size             -1.0653e-02  4.6504e-03 -2.2909  0.021971 *   #> nodes            -8.0716e-02  1.5057e-02 -5.3607 8.288e-08 *** #> prog_recp         2.4843e-03  6.1486e-04  4.0404 5.337e-05 *** #> estrg_recp       -6.8751e-05  5.1367e-04 -0.1338  0.893527     #> grade2 vs grade1 -6.5226e-01  2.5633e-01 -2.5447  0.010938 *   #> grade3 vs grade1 -8.5797e-01  2.8480e-01 -3.0126  0.002590 **  #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 #>  #>  #> Point and interval estimates for the win ratios: #>                  Win Ratio 95% lower CL 95% higher CL #> hormone          1.5254939    1.1547326     2.0152991 #> age              1.0129319    0.9933870     1.0328614 #> size             0.9894031    0.9804261     0.9984623 #> nodes            0.9224554    0.8956306     0.9500837 #> prog_recp        1.0024873    1.0012800     1.0036962 #> estrg_recp       0.9999313    0.9989250     1.0009385 #> grade2 vs grade1 0.5208648    0.3151662     0.8608161 #> grade3 vs grade1 0.4240199    0.2426418     0.7409807 score1 <- score.proc(obj1) oldpar <- par(mfrow = par(\"mfrow\")) par(mfrow = c(3,3)) for(i in c(1:8)){   plot(score1, k = i)   abline(h = 0, col=\"blue\",lty=2)   abline(h = -2, col=\"blue\",lty=2)   abline(h =  2, col=\"blue\",lty=2) } par(oldpar)"},{"path":"https://lmaowisc.github.io/WR/articles/PW_stratify_reg.html","id":"stratification-by-age","dir":"Articles","previous_headings":"AN EXAMPLE WITH THE GERMAN BREAST CANCER STUDY","what":"Stratification by age","title":"Stratified proportional win-fractions (PW) regression of composite endpoints of death and nonfatal event","text":"illustration, fit another PW model stratified finely-cut age groups. Now L>30L>30, better use type II variance estimator inference. can see results similar menopause-stratified analysis. One can also check proportionality assumption similar way using score.proc() function.","code":"## cut age into ~30 groups by quantiles cutpoints <- c(0,unique(quantile(gbc$age[gbc$status<2],                         seq(0.1,1,by=0.02))),Inf) cutpoints #>  [1]  0.0 40.0 41.2 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 #> [16] 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0 64.0 65.0 66.0 67.0 69.0 71.0 #> [31] 80.0  Inf age_group <- cut(gbc$age, breaks = cutpoints, right = FALSE) ## extract the covariate matrix Z from the data ## leaving out age as the stratifying variable Z2 <- as.matrix(gbc[,c(\"hormone\", \"menopause\", \"size\", \"nodes\", \"prog_recp\",                        \"estrg_recp\", \"grade2 vs grade1\", \"grade3 vs grade1\")])  ## fit a PW model stratified by the binary menopause status ## use type II variance estimator because L is large obj2<-pwreg(ID=gbc$id,time=gbc$time,status=gbc$status, Z=Z2,strata=age_group,fixedL=TRUE) ## print out the results print(obj2) #> Call: #> pwreg(ID = gbc$id, time = gbc$time, status = gbc$status, Z = Z2,  #>     strata = age_group, fixedL = TRUE) #>  #> Stratified proportional win-fractions regression analysis #>  #>     (Wang and Mao, 2021+): #>  #> Total number of strata: 31  #> Newton-Raphson algorithm converged in 6 iterations. #>  #> Overall test: chisq test with 8 degrees of freedom;  #>  Wald statistic 75.4 with p-value 4.168887e-13  #>  #> Estimates for Regression parameters: #>                     Estimate          se z.value   p.value     #> hormone           4.8641e-01  1.5611e-01  3.1158 0.0018346 **  #> menopause        -2.1619e-02  2.7309e-01 -0.0792 0.9369026     #> size             -1.1571e-02  5.0177e-03 -2.3060 0.0211088 *   #> nodes            -7.5957e-02  1.7082e-02 -4.4466 8.724e-06 *** #> prog_recp         2.3739e-03  6.4165e-04  3.6996 0.0002159 *** #> estrg_recp       -6.9157e-05  6.0552e-04 -0.1142 0.9090710     #> grade2 vs grade1 -6.3031e-01  2.9273e-01 -2.1532 0.0313009 *   #> grade3 vs grade1 -8.0426e-01  3.2323e-01 -2.4882 0.0128400 *   #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 #>  #>  #> Point and interval estimates for the win ratios: #>                  Win Ratio 95% lower CL 95% higher CL #> hormone          1.6264589    1.1977373     2.2086384 #> menopause        0.9786135    0.5730061     1.6713335 #> size             0.9884957    0.9788219     0.9982650 #> nodes            0.9268558    0.8963381     0.9584125 #> prog_recp        1.0023767    1.0011169     1.0036381 #> estrg_recp       0.9999308    0.9987448     1.0011183 #> grade2 vs grade1 0.5324247    0.2999756     0.9449969 #> grade3 vs grade1 0.4474189    0.2374532     0.8430446"},{"path":"https://lmaowisc.github.io/WR/articles/PW_stratify_reg.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Stratified proportional win-fractions (PW) regression of composite endpoints of death and nonfatal event","text":"Mao, L. Wang, T. (2020). class proportional win-fractions regression models composite outcomes. Biometrics, https://doi.org/10.1111/biom.13382. Pocock, S., Ariti, C., Collier, T., Wang, D. (2012). win ratio: new approach analysis composite endpoints clinical trials based clinical priorities. European Heart Journal, 33, 176–182. Sauerbrei, W., Royston, P., Bojar, H., Schmoor, C., & Schumacher, M. (1999). Modelling effects standard prognostic factors node-positive breast cancer. German Breast Cancer Study Group (GBSG). British Journal Cancer, 79, 1752–1760. Wang, T. Mao, L. (2022). Stratified Proportional Win-fractions Regression Analysis.","code":""},{"path":"https://lmaowisc.github.io/WR/articles/WR_sample_size.html","id":"introduction","dir":"Articles","previous_headings":"","what":"INTRODUCTION","title":"Sample size calculation for standard win ratio test","text":"vignette demonstrates use WR package sample size calculation standard win ratio test death nonfatal event using component-wise hazard ratios effect size (Mao et al., 2021, Biometrics).","code":""},{"path":"https://lmaowisc.github.io/WR/articles/WR_sample_size.html","id":"data-and-the-test","dir":"Articles","previous_headings":"INTRODUCTION","what":"Data and the test","title":"Sample size calculation for standard win ratio test","text":"Let D()D^{()} denote survival time T()T^{()} first nonfatal event time patient group aa, =1a=1 indicates active treatment =0a=0 indicates control. Likewise, use C()C^{()} denote independent censoring time. standard win ratio Pocock et al. (2012), “win” indicator time tt can written 𝒲(D(),T();D(1−),T(1−))(t)=(D(1−)<D()∧t)+(D()∧D(1−)>t,T(1−)<T()∧t),\\mathcal W(D^{()},T^{()}; D^{(1-)},T^{(1-)})(t)= (D^{(1-)}<D^{()}\\wedge t)+(D^{()}\\wedge D^{(1-)}>t, T^{(1-)}<T^{()}\\wedge t), b∧c=min(b,c)b\\wedge c=\\min(b, c). winner goes longer overall survivor , survive past tt, longer event-free survivor. Tweaks rule incorporate recurrent event considered Mao et al. (2022). Using notation, Pocock’s win ratio statistic becomes Sn=∑=1n1∑j=1n0𝒲(Di(1),Ti(1);Dj(0),Tj(0))(Ci(1)∧Cj(0))∑=1n1∑j=1n0𝒲(Dj(0),Tj(0);Di(1),Ti(1))(Ci(1)∧Cj(0)),\\begin{equation}\\tag{1} S_n=\\frac{\\sum_{=1}^{n_1}\\sum_{j=1}^{n_0}\\mathcal W(D_i^{(1)},T_i^{(1)}; D_j^{(0)},T_j^{(0)}) (C_i^{(1)}\\wedge C_j^{(0)})} {\\sum_{=1}^{n_1}\\sum_{j=1}^{n_0}\\mathcal W(D_j^{(0)},T_j^{(0)}; D_i^{(1)},T_i^{(1)}) (C_i^{(1)}\\wedge C_j^{(0)})}, \\end{equation} (Di(),Ti(),Ci())(D_i^{()}, T_i^{()}, C_i^{()})(=1,…,na)(=1,\\ldots, n_a) random nan_a-sample (D(),T(),C())(D^{()}, T^{()}, C^{()})(=1,0)(=1, 0) (right hand side (1) indeed computable censored data). two-sided level-α\\alpha win test group difference rejects null n1/2|logSn|/σ̂n>z1−α/2n^{1/2}|\\log S_n|/\\widehat\\sigma_n>z_{1-\\alpha/2}, n=n1+n0n=n_1+n_0, σ̂n2\\widehat\\sigma_n^2 consistent variance estimator, z1−α/2z_{1-\\alpha/2} (1−α/2)(1-\\alpha/2)th quantile standard normal distribution. Mao (2019) showed test powerful large samples treatment stochastically delays death nonfatal event jointly.","code":""},{"path":"https://lmaowisc.github.io/WR/articles/WR_sample_size.html","id":"methods-for-sample-size-calculation","dir":"Articles","previous_headings":"INTRODUCTION","what":"Methods for sample size calculation","title":"Sample size calculation for standard win ratio test","text":"simplify sample size calculation, posit Gumbel–Hougaard copula model marginal proportional hazards structure D()D^{()} T()T^{()}: P(D()>s,T()>t)=exp(−[{exp(aξ1)λDs}κ+{exp(aξ2)λHt}κ]1/κ),\\begin{equation}\\tag{2} {P}(D^{()}>s, T^{()}>t) =\\exp\\left(-\\left[\\left\\{\\exp(\\xi_1)\\lambda_Ds\\right\\}^\\kappa+ \\left\\{\\exp(\\xi_2)\\lambda_Ht\\right\\}^\\kappa\\right]^{1/\\kappa}\\right), \\end{equation} λD\\lambda_D λH\\lambda_H baseline hazards death nonfatal event, respectively, κ≥1\\kappa\\geq 1 controls correlation (Kendall’s concordance 1−κ−11-\\kappa^{-1}). parameters $\\boldsymbol\\xi:=(\\xi_1,\\xi_2)^{\\rm T}$ component-wise log-hazard ratios comparing treatment control, used effect size sample size calculation. assume patients recruited trial uniformly initial period [0,τb][0, \\tau_b] followed time τ\\tau(τ≥τb)(\\tau\\geq \\tau_b), randomly drop exponential hazard rate λL\\lambda_L. leads C()∼Unif[τ−τb,τ]∧Expn(λL)C^{()}\\sim\\mbox{Unif}[\\tau-\\tau_b,\\tau]\\wedge\\mbox{Expn}(\\lambda_L). outcome parameters λD,λH\\lambda_D, \\lambda_H, κ\\kappa may estimated pilot study data available (see Section 3.2 Mao et al. (2021)), whereas design parameters τb,τ,\\tau_b, \\tau, perhaps λL\\lambda_L best elicited investigators new trial. basic sample size formula $$\\begin{equation}\\tag{3} n=\\frac{\\zeta_0^2(z_{1-\\beta}+z_{1-\\alpha/2})^2}{q(1-q)(\\boldsymbol\\delta_0^{\\rm T}\\boldsymbol\\xi)^2}, \\end{equation}$$ q=n1/nq=n_1/n, 1−β1-\\beta target power, ζ0\\zeta_0 noise parameter similar standard deviation tt-test, 𝛅0\\boldsymbol\\delta_0 bivariate vector containing derivatives true win ratio respect ξ1\\xi_1 ξ2\\xi_2. model (2) outcomes specified follow-design, can calculate ζ02\\zeta_0^2 𝛅0\\boldsymbol\\delta_0 functions λD,λH,κ,τb,τ\\lambda_D, \\lambda_H, \\kappa, \\tau_b, \\tau, λL\\lambda_L numerical means. Note particular depend effect size 𝛏\\boldsymbol\\xi.","code":""},{"path":"https://lmaowisc.github.io/WR/articles/WR_sample_size.html","id":"basic-syntax","dir":"Articles","previous_headings":"","what":"BASIC SYNTAX","title":"Sample size calculation for standard win ratio test","text":"function implements formula (3) WRSS(). need supply least two arguments: xi bivariate effect size 𝛏\\boldsymbol\\xi (log-hazard ratios) list bparam containing zeta2 ζ02\\zeta_0^2 delta 𝛅0\\boldsymbol\\delta_0. , calculated nn can extracted obj$n. default configurations qq, α\\alpha 1−β1-\\beta 0.5, 0.05, 0.8 can nonetheless overridden optional arguments q, alpha, power, respectively. can also change default two-sided test one-sided specifying side=1. function WRSS() almost unremarkable given simplicity underlying formula. takes effort computation ζ02\\zeta_0^2 𝛅0\\boldsymbol\\delta_0 needed bparam. parameters λD,λH,κ,τb,τ\\lambda_D, \\lambda_H, \\kappa, \\tau_b, \\tau, λL\\lambda_L ready, can using base() function: arguments follow order said parameters. returned object bparam can directly used argument WRSS() (precisely list containing zeta2 delta computed ζ02\\zeta_0^2 𝛅0\\boldsymbol\\delta_0, respectively). Due numerical complexity, base() typically require wait time. Finally, pilot dataset estimate λD\\lambda_D, λH\\lambda_H, κ\\kappa baseline outcome distribution, can use gumbel.est() function: id vector containing unique patient identifiers, time vector event times, status vector event type labels: status=2 nonfatal event, =1 death, =0 censoring. returned object list containing real numbers lambda_D, lambda_H, kappa λD\\lambda_D, λH\\lambda_H, κ\\kappa respectively. can fed base() get bparam.","code":"obj<-WRSS(xi,bparam) bparam<-base(lambda_D,lambda_H,kappa,tau_b,tau,lambda_L) gum<-gumbel.est(id, time, status)"},{"path":"https://lmaowisc.github.io/WR/articles/WR_sample_size.html","id":"a-real-example","dir":"Articles","previous_headings":"","what":"A REAL EXAMPLE","title":"Sample size calculation for standard win ratio test","text":"demonstrate use functions calculating sample size win ratio analysis death hospitalization using baseline parameters estimated previous cardiovascular trial.","code":""},{"path":"https://lmaowisc.github.io/WR/articles/WR_sample_size.html","id":"pilot-data-description","dir":"Articles","previous_headings":"A REAL EXAMPLE","what":"Pilot data description","title":"Sample size calculation for standard win ratio test","text":"Heart Failure: Controlled Trial Investigating Outcomes Exercise Training (HF-ACTION) trial conducted cohort two thousand heart failure patients recruited 2003–2007 across USA, Canada, France (O’Connor et al., 2009). study aimed assess effect adding aerobic exercise training usual care patient’s composite endpoint -cause death -cause hospitalization. consider high-risk subgroup consisting 451 study patients. detailed information subgroup, refer vignette Two-sample win ratio tests recurrent event death. first load package clean baseline dataset use.","code":"## load the package library(WR) #> Error in get(paste0(generic, \".\", class), envir = get_method_env()) :  #>   object 'type_sum.accel' not found ## load the dataset data(hfaction_cpx9) dat<-hfaction_cpx9 head(dat) #>        patid       time status trt_ab age60 #> 1 HFACT00001  7.2459016      2      0     1 #> 2 HFACT00001 12.5573770      0      0     1 #> 3 HFACT00002  0.7540984      2      0     1 #> 4 HFACT00002  4.2950820      2      0     1 #> 5 HFACT00002  4.7540984      2      0     1 #> 6 HFACT00002 45.9016393      0      0     1 ## subset to the control group (usual care) pilot<-dat[dat$trt_ab==0,]"},{"path":"https://lmaowisc.github.io/WR/articles/WR_sample_size.html","id":"use-pilot-data-to-estimate-baseline-parameters","dir":"Articles","previous_headings":"A REAL EXAMPLE","what":"Use pilot data to estimate baseline parameters","title":"Sample size calculation for standard win ratio test","text":"Now, can use gumbel.est() functions estimate λD\\lambda_D, λH\\lambda_H, κ\\kappa. gives us λ̂D=0.11\\widehat\\lambda_D=0.11, λ̂H=0.68\\widehat\\lambda_H=0.68, κ̂=1.93\\widehat\\kappa=1.93. Suppose launch new trial lasts τ=4\\tau=4 years, initial accrual period τb=3\\tau_b=3 years. suppose loss follow-rate λL=0.05\\lambda_L=0.05 (half baseline death rate). Combining set-estimated outcome parameters, can calculate ζ02\\zeta_0^2 𝛅0\\boldsymbol\\delta_0 using base() function.","code":"id<-pilot$patid ## convert time from month to year time<-pilot$time/12 status<-pilot$status ## compute the baseline parameters for the Gumbel--Hougaard ## copula for death and hospitalization gum<-gumbel.est(id, time, status) gum #> $lambda_D #> [1] 0.1088785 #>  #> $lambda_H #> [1] 0.679698 #>  #> $kappa #> [1] 1.925483 lambda_D<-gum$lambda_D lambda_H<-gum$lambda_H kappa<-gum$kappa ## max follow-up 4 years tau<-4 ## 3 years of initial accrual tau_b<-3 ## loss to follow-up hazard rate lambda_L=0.05 ## compute the baseline parameters bparam<-base(lambda_D,lambda_H,kappa,tau_b,tau,lambda_L) bparam #> $zeta2 #> [1] 0.2942899 #>  #> $w0 #> [1] 0.4251441 #>  #> $delta #>     delta1     delta2  #> 0.08886542 0.34018646"},{"path":"https://lmaowisc.github.io/WR/articles/WR_sample_size.html","id":"using-wrss-to-compute-sample-size","dir":"Articles","previous_headings":"A REAL EXAMPLE","what":"Using WRSS() to compute sample size","title":"Sample size calculation for standard win ratio test","text":"Now can use computed bparam calculate sample size different combinations component-wise hazard ratios. consider target power 1−β=801-\\beta=80% 9090%. Powered 80%80\\%, sample size ranges 193 $\\exp(\\boldsymbol\\xi)=(0.6, 0.6)^{\\rm T}$ 19,077 $\\exp(\\boldsymbol\\xi)=(0.95, 0.95)^{\\rm T}$; powered 90%90\\%, sample size ranges 258 $\\exp(\\boldsymbol\\xi)=(0.6, 0.6)^{\\rm T}$ 25,539 $\\exp(\\boldsymbol\\xi)=(0.95, 0.95)^{\\rm T}$. can even use 3D plot display calculated sample size function hazard ratios exp(ξ1)\\exp(\\xi_1) exp(ξ2)\\exp(\\xi_2).","code":"## effect size specification thetaD<-seq(0.6,0.95,by=0.05) ## hazard ratio for death thetaH<-seq(0.6,0.95,by=0.05) ## hazard ratio for hospitalization  ## create a matrix \"SS08\" for sample size powered at 80%  ## under each combination of thetaD and thetaH mD<-length(thetaD) mH<-length(thetaH) SS08<-matrix(NA,mD,mH) rownames(SS08)<-thetaD colnames(SS08)<-thetaH ## fill in the computed sample size values for (i in 1:mD){   for (j in 1:mH){     ## sample size under hazard ratios thetaD[i] for death and thetaH[j] for hospitalization     SS08[i,j]<-WRSS(xi=log(c(thetaD[i],thetaH[j])),bparam=bparam,q=0.5,alpha=0.05,                        power=0.8)$n   } } ## print the calculated sample sizes print(SS08) #>           0.6     0.65      0.7     0.75       0.8      0.85      0.9      0.95 #> 0.6  192.3437 250.7878 332.3623 450.1854  627.8914  911.4731 1400.025  2339.457 #> 0.65 205.4637 270.4621 362.6444 498.4542  708.5504 1055.3200 1681.613  2974.743 #> 0.7  218.8455 290.8172 394.5283 550.4150  797.9324 1221.1700 2025.550  3825.411 #> 0.75 232.5145 311.9056 428.1477 606.4539  897.2664 1413.3977 2450.215  4993.647 #> 0.8  246.4942 333.7800 463.6438 666.9984 1007.9865 1637.4667 2981.054  6648.349 #> 0.85 260.8071 356.4934 501.1668 732.5254 1131.7759 1900.2707 3654.047  9084.279 #> 0.9  275.4748 380.1004 540.8778 803.5685 1270.6228 2210.6027 4521.345 12852.227 #> 0.95 290.5186 404.6569 582.9505 880.7278 1426.8882 2579.8125 5660.714 19076.653  ## repeating the same calculation for power = 90% SS09<-matrix(NA,mD,mH) rownames(SS09)<-thetaD colnames(SS09)<-thetaH ## fill in the computed sample size values for (i in 1:mD){   for (j in 1:mH){      ## sample size under hazard ratios thetaD[i] for death and thetaH[j] for hospitalization     SS09[i,j]<-WRSS(xi=log(c(thetaD[i],thetaH[j])),bparam=bparam,q=0.5,alpha=0.05,                        power=0.9)$n   } } ## print the calculated sample sizes print(SS09) #>           0.6     0.65      0.7      0.75       0.8     0.85      0.9      0.95 #> 0.6  257.4937 335.7337 444.9388  602.6705  840.5684 1220.204 1874.236  3131.869 #> 0.65 275.0576 362.0720 485.4779  667.2887  948.5479 1412.774 2251.203  3982.337 #> 0.7  292.9720 389.3217 528.1615  736.8496 1068.2051 1634.800 2711.636  5121.140 #> 0.75 311.2709 417.5531 573.1683  811.8697 1201.1852 1892.139 3280.143  6685.076 #> 0.8  329.9858 446.8367 620.6875  892.9217 1349.4079 2192.103 3990.786  8900.253 #> 0.85 349.1467 477.2435 670.9201  980.6437 1515.1269 2543.923 4891.732 12161.272 #> 0.9  368.7827 508.8465 724.0820 1075.7503 1701.0034 2959.370 6052.798 17205.486 #> 0.95 388.9220 541.7208 780.4053 1179.0446 1910.1985 3453.637 7578.090 25538.227 oldpar <- par(mfrow = par(\"mfrow\")) par(mfrow=c(2,1)) persp(thetaD, thetaH, SS08/1000, theta = 50, phi = 15, expand = 0.8, col = \"gray\",       ltheta = 180, lphi=180, shade = 0.75,       ticktype = \"detailed\",       xlab = \"\\n HR on Death\", ylab = \"\\n HR on Hospitalization\",       zlab=paste0(\"\\n Sample Size (10e3)\"),       main=\"Power = 80%\",       zlim=c(0,26),cex.axis=1,cex.lab=1.2,cex.main=1.2 ) persp(thetaD, thetaH, SS09/1000, theta = 50, phi = 15, expand = 0.8, col = \"gray\",       ltheta = 180, lphi=180, shade = 0.75,       ticktype = \"detailed\",       xlab = \"\\nHR on Death\", ylab = \"\\nHR on Hospitalization\",       zlab=paste0(\"\\n Sample Size (10e3)\"),       main=\"Power = 90%\",       zlim=c(0,26),cex.axis=1,cex.lab=1.2,cex.main=1.2 ) par(oldpar)"},{"path":"https://lmaowisc.github.io/WR/articles/WR_sample_size.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Sample size calculation for standard win ratio test","text":"Mao, L. (2019). alternative hypotheses win ratio. Biometrics, 75, 347-351. https://doi.org/10.1111/biom.12954. Mao, L., Kim, K., & Li, Y. (2022). recurrent-event win ratio. Statistical Methods Medical Research, review. Mao, L., Kim, K., & Miao, X. (2021). Sample size formula general win ratio analysis. Biometrics, https://doi.org/10.1111/biom.13501. O’Connor, C. M., Whellan, D. J., Lee, K. L., Keteyian, S. J., Cooper, L. S., Ellis, S. J., Leifer, E. S., Kraus, W. E., Kitzman, D. W., Blumenthal, J. . et al. (2009). “Efficacy safety exercise training patients chronic heart failure: HF-ACTION randomized controlled trial”. Journal American Medical Association, 301, 1439–1450. Pocock, S., Ariti, C., Collier, T., Wang, D. (2012). win ratio: new approach analysis composite endpoints clinical trials based clinical priorities. European Heart Journal, 33, 176–182.","code":""},{"path":"https://lmaowisc.github.io/WR/articles/WR_test_rec.html","id":"introduction","dir":"Articles","previous_headings":"","what":"INTRODUCTION","title":"Two-sample win ratio tests of possibly recurrent event and death","text":"vignette demonstrates use WR package two-sample win ratio tests recurrent event death (Mao et al., 2022).","code":""},{"path":"https://lmaowisc.github.io/WR/articles/WR_test_rec.html","id":"data","dir":"Articles","previous_headings":"INTRODUCTION","what":"Data","title":"Two-sample win ratio tests of possibly recurrent event and death","text":"Let DD denote survival time write ND(t)=(D≤t)N_D(t)=(D\\leq t). Likewise, let T1<T2<⋯T_1<T_2<\\cdots denote recurrent event times write NH(t)=∑k=1∞(Tk≤t)N_H(t)=\\sum_{k=1}^\\infty (T_k\\leq t). words, NH(t)N_H(t) counting process recurrent event. Since death terminal event, must NH(t)=NH(t∧D)N_H(t)=N_H(t\\wedge D), b∧c=min(b,c)b\\wedge c=\\min(b,c). Let 𝐘(t)={ND(u),NH(u):0≤u≤t}\\boldsymbol Y(t)=\\{N_D(u), N_H(u):0\\leq u\\leq t\\} denote event history time tt. full outcome data without censoring thus 𝐘:=𝐘(τ)\\boldsymbol Y:=\\boldsymbol Y(\\tau), τ\\tau maximum length follow-.","code":""},{"path":"https://lmaowisc.github.io/WR/articles/WR_test_rec.html","id":"general-framework-for-hypotheses-and-tests","dir":"Articles","previous_headings":"INTRODUCTION","what":"General framework for hypotheses and tests","title":"Two-sample win ratio tests of possibly recurrent event and death","text":"Use =1a=1 denote active treatment =0a=0 denote control. notation introduced , use subscript ()() denote corresponding group-specific quantity. example, 𝐘()\\boldsymbol Y^{()} represents outcome data group aa(=1,0)(=1, 0). Consider time-dependent win function form 𝒲(𝐘(),𝐘(1−))(t)=(patient group wins group 1−time t).\\mathcal W(\\boldsymbol Y^{()}, \\boldsymbol Y^{(1-)})(t)  = (\\mbox{patient group $$ wins group $1-$ time $t$}). specific definition 𝒲\\mathcal W discussed later. Given rule cross-group comparison, win loss probabilities treatment control time tt w(t)=E{𝒲(𝐘(1),𝐘(0))(t)}w(t)=E\\{\\mathcal W(\\boldsymbol Y^{(1)}, \\boldsymbol Y^{(0)})(t)\\} l(t)=E{𝒲(𝐘(0),𝐘(0))(t)}l(t)=E\\{\\mathcal W(\\boldsymbol Y^{(0)}, \\boldsymbol Y^{(0)})(t)\\}, respectively. Suppose wish test null hypothesis win loss probabilities equal, .e., $$H_0: w(t)=l(t)\\hspace{2ex}\\mbox{}t\\[0, \\tau],$$ alternative hypothesis win probability dominates loss probability, .e., $$\\begin{equation}\\tag{1} H_A: w(t)\\geq l(t)\\hspace{1ex}\\mbox{}t\\[0, \\tau] \\mbox{ strict inequality }t. \\end{equation}$$ censored data, general way test hypotheses use log-transformed two-sample win ratio constructed similarly Pocock et al. (2012), pairwise rule comparison replaced customized 𝒲(⋅,⋅)(t)\\mathcal W(\\cdot,\\cdot)(t), tt set earlier two observed follow-times. stratified test can also developed along lines Dong et al. (2018).","code":""},{"path":"https://lmaowisc.github.io/WR/articles/WR_test_rec.html","id":"choice-of-win-function","dir":"Articles","previous_headings":"INTRODUCTION","what":"Choice of win function","title":"Two-sample win ratio tests of possibly recurrent event and death","text":"Different choices 𝒲\\mathcal W lead different hypotheses tests. standard win ratio (SWR) Pocock et al. (2012) corresponds choice 𝒲S(𝐘(),𝐘(1−))(t)=(D(1−)<D()∧t)+(D()∧D(1−)>t,T1(1−)<T1()∧t).\\mathcal W_S(\\boldsymbol Y^{()}, \\boldsymbol Y^{(1-)})(t) =(D^{(1-)}<D^{()}\\wedge t)+(D^{()}\\wedge D^{(1-)}>t, T_1^{(1-)}<T_1^{()}\\wedge t). recurrent nonfatal event, 𝒲S\\mathcal W_S fails fully exploit data draws first occurrence. efficient rule given last-event-assisted win ratio (LWR), compares nonfatal event first cumulative frequency, ties broken time last episode. words, $$\\begin{align} \\mathcal W_L(\\boldsymbol Y^{()}, \\boldsymbol Y^{(1-)})(t) &=(D^{(1-)}<D^{()}\\wedge t)+\\{D^{()}\\wedge D^{(1-)}>t, N_H^{()}(t)<N_H^{(1-)}(t)\\}\\\\ &\\hspace{1ex}+\\{D^{()}\\wedge D^{(1-)}>t, N_H^{()}(t)=N_H^{(1-)}(t)=\\mbox{ } k, T_k^{(1-)}<T_k^{()}\\}. \\end{align}$$ Likewise can construct first-event-assisted win ratio (FWR) replacing Tk()T_k^{()} T1()T_1^{()}, naive win ratio (NWR) removing tie-breaking third term altogether (see Mao et al. (2022) details). Nonetheless, recommended LWR used default, makes fuller use data reduces SWR nonfatal event occurs . LWR, simple condition implies dominance win probability (1) joint stochastic order event times two groups: P(D(1)>s,T1(1)>t1,T2(1)>t2,…)>P(D(0)>s,T1(0)>t1,T2(0)>t2,…),\\begin{equation}\\tag{2} {P}(D^{(1)}>s, T^{(1)}_{1}>t_1, T^{(1)}_{2}>t_2, \\ldots)> {P}(D^{(0)}>s, T^{(0)}_{1}>t_1, T^{(0)}_{2}>t_2, \\ldots), \\end{equation} 0≤t1≤t2≤⋯≤s≤τ0\\leq t_1\\leq t_2\\leq\\cdots\\leq s\\leq\\tau. Expression (2) means treatment stochastically delays events, fatal nonfatal, jointly compared control. Hence, (2) true, LWR test rejects H0H_0 probability tending 1 sample size increases infinity.","code":""},{"path":"https://lmaowisc.github.io/WR/articles/WR_test_rec.html","id":"basic-syntax","dir":"Articles","previous_headings":"","what":"BASIC SYNTAX","title":"Two-sample win ratio tests of possibly recurrent event and death","text":"basic function perform win ratio tests WRrec(). use function, input data must “long” format. Specifically, need ID variable containing unique patient identifiers, time variable containing event times, status variable labeling event type (status=2 recurrent non-fatal event, =1 death, =0 censoring), , finally, binary trt variable 1 indicating treatment 0 indicating control. perform unstratified LWR test, use stratified test, supply vector stratifying (categorical) variable additional strata= argument. get test results FWR NWR well, add option naive=TRUE. Printing object obj gives us pp-values tests well descriptive statistics.","code":"obj<-WRrec(ID,time,status,trt)"},{"path":[]},{"path":"https://lmaowisc.github.io/WR/articles/WR_test_rec.html","id":"data-description","dir":"Articles","previous_headings":"AN EXAMPLE WITH THE HF-ACTION TRIAL","what":"Data description","title":"Two-sample win ratio tests of possibly recurrent event and death","text":"illustrate win ratio tests, consider Heart Failure: Controlled Trial Investigating Outcomes Exercise Training (HF-ACTION) trial. randomized controlled trial, HF-ACTION conducted cohort two thousand heart failure patients recruited 2003–2007 across USA, Canada, France (O’Connor et al., 2009). study aimed assess effect adding aerobic exercise training usual care patient’s composite endpoint -cause death -cause hospitalization. primary analysis whole study population showed moderate non-significant reduction risk time first composite event (hazard ratio 0.93; pp-value 0.13). focus subgroup non-ischemic patients reduced cardio-pulmonary exercise (CPX) test duration (.e., ≤9\\leq 9 minutes reporting discomfort). scientific empirical evidence suggesting particular sub-population may benefit exercise training interventions average heart failure patient. associated dataset hfaction_cpx9 contained WR package can loaded dataset already format suitable WRrec() (status= 2 hospitalization = 1 death). time variable units months trt=0 usual care (control) 1 exercise training. age60 variable indicator patient age greater equal 60 years can potentially serve stratifying variable.","code":"library(WR) #> Error in get(paste0(generic, \".\", class), envir = get_method_env()) :  #>   object 'type_sum.accel' not found head(hfaction_cpx9) #>        patid       time status trt_ab age60 #> 1 HFACT00001  7.2459016      2      0     1 #> 2 HFACT00001 12.5573770      0      0     1 #> 3 HFACT00002  0.7540984      2      0     1 #> 4 HFACT00002  4.2950820      2      0     1 #> 5 HFACT00002  4.7540984      2      0     1 #> 6 HFACT00002 45.9016393      0      0     1"},{"path":"https://lmaowisc.github.io/WR/articles/WR_test_rec.html","id":"win-ratio-tests-on-recurrent-event-and-death","dir":"Articles","previous_headings":"AN EXAMPLE WITH THE HF-ACTION TRIAL","what":"Win ratio tests on recurrent event and death","title":"Two-sample win ratio tests of possibly recurrent event and death","text":"perform win ratio tests exercise training usual care stratified age, use code can see output 57 (25.8%) 221 patients died usual care, average 571/221=2.6571/221=2.6 hospitalizations per patient; 36 (17.6%) 205 patients died exercise training average 451/205=2.2451/205=2.2 hospitalizations per patient. Clearly, undergoing exercise training much better terms overall survival recurrent hospitalization. Following descriptive statistics analysis results LWR, FWR, NWR. Although estimates overall win loss probabilities, well win ratio, provided, magnitudes generally dependent censoring distribution thus interpreted caution. hand, pp-values valid tests null alternative hypotheses discussed earlier section. can see three tests yield pp-values less conventional threshold 0.05, suggesting exercise training significantly reduces mortality recurrent hospitalization.","code":"## simplify the dataset name dat<-hfaction_cpx9 ## comparing exercise training to usual care by LWR, FWR, and NWR obj<-WRrec(ID=dat$patid,time=dat$time,status=dat$status,           trt=dat$trt_ab,strata=dat$age60,naive=TRUE) ## print the results obj #> Call: #> WRrec(ID = dat$patid, time = dat$time, status = dat$status, trt = dat$trt_ab,  #>     strata = dat$age60, naive = TRUE) #>  #>             N Rec. Event Death Med. Follow-up #> Control   221        571    57       28.62295 #> Treatment 205        451    36       27.57377 #>  #> Analysis of last-event-assisted WR (LWR; recommended), first-event-assisted WR (FWR), and naive WR (NWR): #>     Win prob Loss prob WR (95% CI)*      p-value #> LWR 50.4%    38.2%     1.32 (1.05, 1.66) 0.0189  #> FWR 50.4%    38.3%     1.32 (1.04, 1.66) 0.0202  #> NWR 47%      35%       1.34 (1.05, 1.72) 0.0193  #> ----- #> *Note: The scale of WR should be interpreted with caution as it depends on  #> censoring distribution without modeling assumptions."},{"path":"https://lmaowisc.github.io/WR/articles/WR_test_rec.html","id":"comparison-with-standard-win-ratio","dir":"Articles","previous_headings":"AN EXAMPLE WITH THE HF-ACTION TRIAL","what":"Comparison with standard win ratio","title":"Two-sample win ratio tests of possibly recurrent event and death","text":"compare SWR, first create dataset first hospitalization retained. perform SWR test applying procedure LWR reduced dataset (case equivalent SWR). can see test result borderline significant, possibly due less efficient use recurrent-event data.","code":"###################################### ## Remove recurrent hospitalization ## ###################################### ## sort dataset by patid and time o<-order(dat$patid,dat$time) dat<-dat[o,] ## retain only the first hospitalization datHF<-dat[!duplicated(dat[c(\"patid\",\"status\")]),] head(datHF) #>         patid       time status trt_ab age60 #> 1  HFACT00001  7.2459016      2      0     1 #> 2  HFACT00001 12.5573770      0      0     1 #> 3  HFACT00002  0.7540984      2      0     1 #> 6  HFACT00002 45.9016393      0      0     1 #> 7  HFACT00007  3.4754098      2      1     1 #> 11 HFACT00007 34.8852459      1      1     1 ## Perform the standard win ratio test objSWR<-WRrec(ID=datHF$patid,time=datHF$time,status=datHF$status,           trt=datHF$trt_ab,strata=datHF$age60) ## print the results objSWR #> Call: #> WRrec(ID = datHF$patid, time = datHF$time, status = datHF$status,  #>     trt = datHF$trt_ab, strata = datHF$age60) #>  #>             N Rec. Event Death Med. Follow-up #> Control   221        170    57       28.62295 #> Treatment 205        145    36       27.57377 #>  #> Analysis of last-event-assisted WR (LWR): #>     Win prob Loss prob WR (95% CI)*  p-value #> LWR 49.5%    39.1%     1.27 (1, 1.6) 0.0494  #> ----- #> *Note: The scale of WR should be interpreted with caution as it depends on  #> censoring distribution without modeling assumptions."},{"path":"https://lmaowisc.github.io/WR/articles/WR_test_rec.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Two-sample win ratio tests of possibly recurrent event and death","text":"Dong, G., Qiu, J., Wang, D., & Vandemeulebroecke, M. (2018). stratified win ratio. Journal Biopharmaceutical Statistics, 28, 778–796. Mao, L., Kim, K., & Li, Y. (2022). recurrent-event win ratio. Statistical Methods Medical Research, review. O’Connor, C. M., Whellan, D. J., Lee, K. L., Keteyian, S. J., Cooper, L. S., Ellis, S. J., Leifer, E. S., Kraus, W. E., Kitzman, D. W., Blumenthal, J. . et al. (2009). “Efficacy safety exercise training patients chronic heart failure: HF-ACTION randomized controlled trial”. Journal American Medical Association, 301, 1439–1450. Pocock, S., Ariti, C., Collier, T., Wang, D. (2012). win ratio: new approach analysis composite endpoints clinical trials based clinical priorities. European Heart Journal, 33, 176–182.","code":""},{"path":"https://lmaowisc.github.io/WR/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Lu Mao. Maintainer.","code":""},{"path":"https://lmaowisc.github.io/WR/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Mao L, Wang T (2024). WR: Win Ratio Analysis Composite Time--Event Outcomes. R package version 1.0.1, https://lmaowisc.github.io/WR/, https://sites.google.com/view/lmaowisc/.","code":"@Manual{,   title = {WR: Win Ratio Analysis of Composite Time-to-Event Outcomes},   author = {Lu Mao and Tuo Wang},   year = {2024},   note = {R package version 1.0.1, https://lmaowisc.github.io/WR/},   url = {https://sites.google.com/view/lmaowisc/}, }"},{"path":"https://lmaowisc.github.io/WR/index.html","id":"wr","dir":"","previous_headings":"","what":"Win Ratio Analysis of Composite Time-to-Event Outcomes","title":"Win Ratio Analysis of Composite Time-to-Event Outcomes","text":"WR package implements various win ratio methodologies composite endpoints death non-fatal events, including (stratified) proportional win-fractions (PW) regression models (Mao Wang, 2020 doi:10.1111/biom.13382), (stratified) two-sample tests possibly recurrent nonfatal event, sample size calculation standard win ratio test (Mao et al., 2021 doi:10.1111/biom.13501).","code":""},{"path":"https://lmaowisc.github.io/WR/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Win Ratio Analysis of Composite Time-to-Event Outcomes","text":"Install WR CRAN : can install development version GitHub :","code":"install.packages(\"WR\") # install.packages(\"devtools\") devtools::install_github(\"lmaowisc/WR\")"},{"path":"https://lmaowisc.github.io/WR/index.html","id":"examples","dir":"","previous_headings":"","what":"Examples","title":"Win Ratio Analysis of Composite Time-to-Event Outcomes","text":"basic example.","code":""},{"path":[]},{"path":"https://lmaowisc.github.io/WR/reference/WR-package.html","id":null,"dir":"Reference","previous_headings":"","what":"WR: Win Ratio Analysis of Composite Time-to-Event Outcomes — WR-package","title":"WR: Win Ratio Analysis of Composite Time-to-Event Outcomes — WR-package","text":"Implements various win ratio methodologies composite endpoints death non-fatal events, including (stratified) proportional win-fractions (PW) regression models (Mao Wang, 2020 doi:10.1111/biom.13382 ), (stratified) two-sample tests possibly recurrent nonfatal event, sample size calculation standard win ratio test (Mao et al., 2021 doi:10.1111/biom.13501 ).","code":""},{"path":[]},{"path":"https://lmaowisc.github.io/WR/reference/WRSS.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the sample size for standard win ratio test — WRSS","title":"Compute the sample size for standard win ratio test — WRSS","text":"Compute sample size standard win ratio test.","code":""},{"path":"https://lmaowisc.github.io/WR/reference/WRSS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the sample size for standard win ratio test — WRSS","text":"","code":"WRSS(xi, bparam, q = 0.5, alpha = 0.05, side = 2, power = 0.8)"},{"path":"https://lmaowisc.github.io/WR/reference/WRSS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the sample size for standard win ratio test — WRSS","text":"xi bivariate vector hypothesized component-wise (treatment--control) log-hazard ratios Gumbel–Hougaard copula model described base. bparam list containing baseline parameters zeta2 \\(\\zeta_0^2\\) delta \\(\\boldsymbol\\delta_0\\); Can directly use output base. q Proportion patients assigned treatment. alpha Type error rate. side 2-sided 1-sided test. power Target power.","code":""},{"path":"https://lmaowisc.github.io/WR/reference/WRSS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the sample size for standard win ratio test — WRSS","text":"list containing n, computed sample size.","code":""},{"path":"https://lmaowisc.github.io/WR/reference/WRSS.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Compute the sample size for standard win ratio test — WRSS","text":"Mao, L., Kim, K. Miao, X. (2021). Sample size formula general win ratio analysis. Biometrics, https://doi.org/10.1111/biom.13501.","code":""},{"path":[]},{"path":"https://lmaowisc.github.io/WR/reference/WRSS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute the sample size for standard win ratio test — WRSS","text":"","code":"# The following is not run in package checking to save time. if (FALSE) { # \\dontrun{ ## load the package and pilot dataset library(WR) head(hfaction_cpx9) dat<-hfaction_cpx9 ## subset to control group pilot<-dat[dat$trt_ab==0,]  ## get the data ready for gumbel.est() id<-pilot$patid ## convert time from month to year time<-pilot$time/12 status<-pilot$status ## compute the baseline parameters for the Gumbel--Hougaard ## copula for death and hospitalization gum<-gumbel.est(id, time, status)  ## get the baseline parameters lambda_D<-gum$lambda_D lambda_H<-gum$lambda_H kappa<-gum$kappa ## set up design parameters and use base() ## to calculate bparam for WRSS() # max follow-up 4 years tau<-4 # 3 years of initial accrual tau_b<-3 # loss to follow-up rate lambda_L=0.05 # compute the baseline parameters bparam<-base(lambda_D,lambda_H,kappa,tau_b,tau,lambda_L) bparam  ## sample size with power=0.8 under hazard ratios ## 0.9 and 0.8 for death and hospitalization, respectively. WRSS(xi=log(c(0.9,0.8)),bparam=bparam,q=0.5,alpha=0.05,     power=0.8)$n ## sample size under the same set-up but with power 0.9 WRSS(xi=log(c(0.9,0.8)),bparam=bparam,q=0.5,alpha=0.05,     power=0.9)$n } # }"},{"path":"https://lmaowisc.github.io/WR/reference/WRrec.html","id":null,"dir":"Reference","previous_headings":"","what":"Generalized win ratio tests — WRrec","title":"Generalized win ratio tests — WRrec","text":"Perform stratified two-sample test possibly recurrent nonfatal event death using recommended last-event assisted win ratio (LWR), /naive win ratio (NWR) first-event assisted win ratio (FWR) (Mao et al., 2022). LWR FWR reduce standard win ratio Pocock et al. (2012).","code":""},{"path":"https://lmaowisc.github.io/WR/reference/WRrec.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generalized win ratio tests — WRrec","text":"","code":"WRrec(ID, time, status, trt, strata = NULL, naive = FALSE)"},{"path":"https://lmaowisc.github.io/WR/reference/WRrec.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generalized win ratio tests — WRrec","text":"ID vector unique patient identifiers. time numeric vector event times. status vector event type variable; 2 = recurrent event, 1 = death, 0 = censoring. trt vector binary treatment indicators. strata vector categorical variable strata; Default NULL, leads unstratified analysis. naive TRUE, results NWR FWR provided addition LWR; Default FALSE, gives LWR .","code":""},{"path":"https://lmaowisc.github.io/WR/reference/WRrec.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generalized win ratio tests — WRrec","text":"object class WRrec, contains following elements. theta bivariate vector win/loss fractions LWR. log.WR, se Log-win ratio estimate standard error LWR. pval \\(p\\)-value LWR test. theta.naive bivariate vector win/loss fractions NWR. log.WR.naive, se.naive Log-win ratio estimate standard error NWR. theta.FI bivariate vector win/loss fractions FWR. log.WR.FI, se.FI Log-win ratio estimate standard error FWR. ...","code":""},{"path":"https://lmaowisc.github.io/WR/reference/WRrec.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Generalized win ratio tests — WRrec","text":"Mao, L., Kim, K. Li, Y. (2022). recurrent-event win ratio. Statistical Methods Medical Research, review. Pocock, S., Ariti, C., Collier, T., Wang, D. (2012). win ratio: new approach analysis composite endpoints clinical trials based clinical priorities.  European Heart Journal, 33, 176–182.","code":""},{"path":[]},{"path":"https://lmaowisc.github.io/WR/reference/WRrec.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generalized win ratio tests — WRrec","text":"","code":"## load the HF-ACTION trial data library(WR) head(hfaction_cpx9) #>        patid       time status trt_ab age60 #> 1 HFACT00001  7.2459016      2      0     1 #> 2 HFACT00001 12.5573770      0      0     1 #> 3 HFACT00002  0.7540984      2      0     1 #> 4 HFACT00002  4.2950820      2      0     1 #> 5 HFACT00002  4.7540984      2      0     1 #> 6 HFACT00002 45.9016393      0      0     1 dat<-hfaction_cpx9 ## Comparing exercise training to usual care by LWR, FWR, and NWR obj<-WRrec(ID=dat$patid,time=dat$time,status=dat$status,           trt=dat$trt_ab,strata=dat$age60,naive=TRUE) ## print the results obj #> Call: #> WRrec(ID = dat$patid, time = dat$time, status = dat$status, trt = dat$trt_ab,  #>     strata = dat$age60, naive = TRUE) #>  #>             N Rec. Event Death Med. Follow-up #> Control   221        571    57       28.62295 #> Treatment 205        451    36       27.57377 #>  #> Analysis of last-event-assisted WR (LWR; recommended), first-event-assisted WR (FWR), and naive WR (NWR): #>     Win prob Loss prob WR (95% CI)*      p-value #> LWR 50.4%    38.2%     1.32 (1.05, 1.66) 0.0189  #> FWR 50.4%    38.3%     1.32 (1.04, 1.66) 0.0202  #> NWR 47%      35%       1.34 (1.05, 1.72) 0.0193  #> ----- #> *Note: The scale of WR should be interpreted with caution as it depends on  #> censoring distribution without modeling assumptions."},{"path":"https://lmaowisc.github.io/WR/reference/base.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the baseline parameters needed for sample size calculation for standard win ratio test — base","title":"Compute the baseline parameters needed for sample size calculation for standard win ratio test — base","text":"Compute baseline parameters \\(\\zeta_0^2\\) \\(\\boldsymbol\\delta_0\\) needed sample size calculation standard win ratio test (see WRSS). calculation based Gumbel–Hougaard copula model survival time \\(D^{()}\\) nonfatal event time \\(T^{()}\\) group \\(\\) (1: treatment; 0: control): $${P}(D^{()}>s, T^{()}>t) =\\exp\\left(-\\left[\\left\\{\\exp(\\xi_1)\\lambda_Ds\\right\\}^\\kappa+ \\left\\{\\exp(\\xi_2)\\lambda_Ht\\right\\}^\\kappa\\right]^{1/\\kappa}\\right),$$ \\(\\xi_1\\) \\(\\xi_2\\) component-wise log-hazard ratios used effect size WRSS. also assume patients recruited uniformly period \\([0, \\tau_b]\\) followed time \\(\\tau\\)  (\\(\\tau\\geq\\tau_b\\)), exponential loss--follow-hazard \\(\\lambda_L\\).","code":""},{"path":"https://lmaowisc.github.io/WR/reference/base.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the baseline parameters needed for sample size calculation for standard win ratio test — base","text":"","code":"base(lambda_D, lambda_H, kappa, tau_b, tau, lambda_L, N = 1000, seed = 12345)"},{"path":"https://lmaowisc.github.io/WR/reference/base.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the baseline parameters needed for sample size calculation for standard win ratio test — base","text":"lambda_D Baseline hazard \\(\\lambda_D\\) death. lambda_H Baseline hazard \\(\\lambda_H\\) nonfatal event. kappa Gumbel–Hougaard copula correlation parameter \\(\\kappa\\). tau_b Length initial (uniform) accrual period \\(\\tau_b\\). tau Total length follow-\\(\\tau\\). lambda_L Exponential hazard rate \\(\\lambda_L\\) random loss follow-. N Simulated sample size monte-carlo integration. seed Seed monte-carlo simulation.","code":""},{"path":"https://lmaowisc.github.io/WR/reference/base.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the baseline parameters needed for sample size calculation for standard win ratio test — base","text":"list containing real number zeta2 \\(\\zeta_0^2\\) bivariate vector delta \\(\\boldsymbol\\delta_0\\).","code":""},{"path":"https://lmaowisc.github.io/WR/reference/base.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Compute the baseline parameters needed for sample size calculation for standard win ratio test — base","text":"Mao, L., Kim, K. Miao, X. (2021). Sample size formula general win ratio analysis. Biometrics, https://doi.org/10.1111/biom.13501.","code":""},{"path":[]},{"path":"https://lmaowisc.github.io/WR/reference/base.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute the baseline parameters needed for sample size calculation for standard win ratio test — base","text":"","code":"# see the example for WRSS"},{"path":"https://lmaowisc.github.io/WR/reference/gbc.html","id":null,"dir":"Reference","previous_headings":"","what":"A subset of the German Breast Cancer study data — gbc","title":"A subset of the German Breast Cancer study data — gbc","text":"subset German Breast Cancer study data.","code":""},{"path":"https://lmaowisc.github.io/WR/reference/gbc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A subset of the German Breast Cancer study data — gbc","text":"","code":"gbc"},{"path":"https://lmaowisc.github.io/WR/reference/gbc.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"A subset of the German Breast Cancer study data — gbc","text":"data frame 985 rows 12 variables: id subject IDs time event times (months) status event status; 0:censoring, 1:death, 2:cancer recurrence hormone treatment indicator: 1=Hormone therapy; 2=standard therapy age age diagnosis (years) menopause menopausal Status; 1=; 2=Yes size tumor size grade tumor grade, 1-3 nodes number nodes involved prog_recp number progesterone receptors estrg_recp number estrogen receptors","code":""},{"path":"https://lmaowisc.github.io/WR/reference/gbc.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"A subset of the German Breast Cancer study data — gbc","text":"Sauerbrei, W., Royston, P., Bojar, H., Schmoor, C. Schumacher, M. (1999). Modelling effects standard prognostic factors node-positive breast cancer. German Breast Cancer Study Group (GBSG). British Journal Cancer, 79, 1752–1760. Hosmer, D.W. Lemeshow, S. May, S. (2008) Applied Survival Analysis: Regression Modeling Time Event Data: Second Edition, John Wiley Sons Inc., New York, NY","code":""},{"path":"https://lmaowisc.github.io/WR/reference/gumbel.est.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate baseline parameters in the Gumbel–Hougaard model for sample size calculation using pilot data — gumbel.est","title":"Estimate baseline parameters in the Gumbel–Hougaard model for sample size calculation using pilot data — gumbel.est","text":"Estimate baseline parameters Gumbel–Hougaard model described base sample size calculation using pilot study data.","code":""},{"path":"https://lmaowisc.github.io/WR/reference/gumbel.est.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate baseline parameters in the Gumbel–Hougaard model for sample size calculation using pilot data — gumbel.est","text":"","code":"gumbel.est(id, time, status)"},{"path":"https://lmaowisc.github.io/WR/reference/gumbel.est.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate baseline parameters in the Gumbel–Hougaard model for sample size calculation using pilot data — gumbel.est","text":"id vector unique patient identifiers. time numeric vector event times. status vector event type variable; 2 = nonfatal event, 1 = death, 0 = censoring.","code":""},{"path":"https://lmaowisc.github.io/WR/reference/gumbel.est.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate baseline parameters in the Gumbel–Hougaard model for sample size calculation using pilot data — gumbel.est","text":"list containing lambda_D \\(\\lambda_D\\), lambda_H \\(\\lambda_H\\), kappa \\(\\kappa\\) Gumbel–Hougaard model.","code":""},{"path":"https://lmaowisc.github.io/WR/reference/gumbel.est.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Estimate baseline parameters in the Gumbel–Hougaard model for sample size calculation using pilot data — gumbel.est","text":"Mao, L., Kim, K. Miao, X. (2021). Sample size formula general win ratio analysis. Biometrics, https://doi.org/10.1111/biom.13501.","code":""},{"path":[]},{"path":"https://lmaowisc.github.io/WR/reference/gumbel.est.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate baseline parameters in the Gumbel–Hougaard model for sample size calculation using pilot data — gumbel.est","text":"","code":"# see the example for WRSS"},{"path":"https://lmaowisc.github.io/WR/reference/hfaction_cpx9.html","id":null,"dir":"Reference","previous_headings":"","what":"A subset of the HF-ACTION study data on high-risk non-ischemic heart failure patients — hfaction_cpx9","title":"A subset of the HF-ACTION study data on high-risk non-ischemic heart failure patients — hfaction_cpx9","text":"data subgroup 426 high-risk non-ischemic patients HF-ACTION study.","code":""},{"path":"https://lmaowisc.github.io/WR/reference/hfaction_cpx9.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A subset of the HF-ACTION study data on high-risk non-ischemic heart failure patients — hfaction_cpx9","text":"","code":"hfaction_cpx9"},{"path":"https://lmaowisc.github.io/WR/reference/hfaction_cpx9.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"A subset of the HF-ACTION study data on high-risk non-ischemic heart failure patients — hfaction_cpx9","text":"data frame 1,448 rows 5 variables: patid patient ID time event times (months) status event status; 0:censoring, 1:death, 2:hospitalization trt_ab treatment indicator: 1: exercise training, 0: usual care age60 1: 60 years older, 0: less 60 years old","code":""},{"path":"https://lmaowisc.github.io/WR/reference/hfaction_cpx9.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"A subset of the HF-ACTION study data on high-risk non-ischemic heart failure patients — hfaction_cpx9","text":"O'Connor, C. M., Whellan, D. J., Lee, K. L., Keteyian, S. J., Cooper, L. S., Ellis, S. J., Leifer, E. S., Kraus, W. E., Kitzman, D. W., Blumenthal, J. . et al. (2009). Efficacy safety exercise training patients chronic heart failure: HF-ACTION randomized controlled trial. Journal American Medical Association, 301, 1439–1450.","code":""},{"path":"https://lmaowisc.github.io/WR/reference/non_ischemic.html","id":null,"dir":"Reference","previous_headings":"","what":"A subset of the HF-ACTION study data on non-ischemic heart failure patients with full covariate measurement. — non_ischemic","title":"A subset of the HF-ACTION study data on non-ischemic heart failure patients with full covariate measurement. — non_ischemic","text":"subset data 451 non-ischemic patients HF-ACTION study complete baseline covariates.","code":""},{"path":"https://lmaowisc.github.io/WR/reference/non_ischemic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A subset of the HF-ACTION study data on non-ischemic heart failure patients with full covariate measurement. — non_ischemic","text":"","code":"non_ischemic"},{"path":"https://lmaowisc.github.io/WR/reference/non_ischemic.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"A subset of the HF-ACTION study data on non-ischemic heart failure patients with full covariate measurement. — non_ischemic","text":"data frame 751 rows 16 variables: ID subject IDs time event times (days) status event status; 0:censoring, 1:death, 2:hospitalization trt_ab treatment indicator: 1=exercise training; 0=usual care age patient age years sex 1=female; 2=male Black.vs.White 1=black; 0=otherwise .vs.White 1=race black white; 0=otherwise bmi body mass index bipllvef (biplane) left-ventricular ejection fraction hyperten indicator history hypertension COPD indicator history COPD diabetes indicator history diabetes acei indicator current use ACE inhibitors betab indicator current use beta blockers smokecurr indicator current smoker","code":""},{"path":"https://lmaowisc.github.io/WR/reference/non_ischemic.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"A subset of the HF-ACTION study data on non-ischemic heart failure patients with full covariate measurement. — non_ischemic","text":"O'Connor, C. M., Whellan, D. J., Lee, K. L., Keteyian, S. J., Cooper, L. S., Ellis, S. J., Leifer, E. S., Kraus, W. E., Kitzman, D. W., Blumenthal, J. . et al. (2009). Efficacy safety exercise training patients chronic heart failure: HF-ACTION randomized controlled trial. Journal American Medical Association, 301, 1439–1450.","code":""},{"path":"https://lmaowisc.github.io/WR/reference/plot.pwreg.score.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the standardized score processes — plot.pwreg.score","title":"Plot the standardized score processes — plot.pwreg.score","text":"Plot standardized score processes.","code":""},{"path":"https://lmaowisc.github.io/WR/reference/plot.pwreg.score.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the standardized score processes — plot.pwreg.score","text":"","code":"# S3 method for class 'pwreg.score' plot(   x,   k,   xlab = \"Time\",   ylab = \"Standardized score\",   lty = 1,   frame.plot = TRUE,   add = FALSE,   ylim = c(-3, 3),   xlim = NULL,   lwd = 1,   ... )"},{"path":"https://lmaowisc.github.io/WR/reference/plot.pwreg.score.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the standardized score processes — plot.pwreg.score","text":"x object class pwreg.score. k positive integer indicating order covariate plotted. example, k=3 requests standardized score process third covariate covariate matrix Z. xlab title x axis. ylab title y axis. lty line type. Default 1. frame.plot logical variable indicating frame drawn 1D case. add logical variable indicating whether add current plot? ylim vector indicating range y-axis. Default (-3,3). xlim vector indicating range x-axis. Default NULL. lwd line width, positive number. Default 1. ... arguments passed methods.","code":""},{"path":"https://lmaowisc.github.io/WR/reference/plot.pwreg.score.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the standardized score processes — plot.pwreg.score","text":"plot standardized score process object pwreg.score.","code":""},{"path":[]},{"path":"https://lmaowisc.github.io/WR/reference/plot.pwreg.score.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot the standardized score processes — plot.pwreg.score","text":"","code":"# see the example for score.proc"},{"path":"https://lmaowisc.github.io/WR/reference/print.WRrec.html","id":null,"dir":"Reference","previous_headings":"","what":"Print the results of the two-sample recurrent-event win ratio analysis — print.WRrec","title":"Print the results of the two-sample recurrent-event win ratio analysis — print.WRrec","text":"Print results two-sample recurrent-event win ratio analysis.","code":""},{"path":"https://lmaowisc.github.io/WR/reference/print.WRrec.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print the results of the two-sample recurrent-event win ratio analysis — print.WRrec","text":"","code":"# S3 method for class 'WRrec' print(x, ...)"},{"path":"https://lmaowisc.github.io/WR/reference/print.WRrec.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print the results of the two-sample recurrent-event win ratio analysis — print.WRrec","text":"x object class WRrec. ... arguments passed methods.","code":""},{"path":"https://lmaowisc.github.io/WR/reference/print.WRrec.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print the results of the two-sample recurrent-event win ratio analysis — print.WRrec","text":"Print results WRrec object.","code":""},{"path":[]},{"path":"https://lmaowisc.github.io/WR/reference/print.WRrec.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print the results of the two-sample recurrent-event win ratio analysis — print.WRrec","text":"","code":"# see the example for WRrec"},{"path":"https://lmaowisc.github.io/WR/reference/print.pwreg.html","id":null,"dir":"Reference","previous_headings":"","what":"Print the results of the proportional win-fractions regression model — print.pwreg","title":"Print the results of the proportional win-fractions regression model — print.pwreg","text":"Print results proportional win-fractions regression model.","code":""},{"path":"https://lmaowisc.github.io/WR/reference/print.pwreg.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print the results of the proportional win-fractions regression model — print.pwreg","text":"","code":"# S3 method for class 'pwreg' print(x, ...)"},{"path":"https://lmaowisc.github.io/WR/reference/print.pwreg.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print the results of the proportional win-fractions regression model — print.pwreg","text":"x object class pwreg. ... arguments passed methods.","code":""},{"path":"https://lmaowisc.github.io/WR/reference/print.pwreg.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print the results of the proportional win-fractions regression model — print.pwreg","text":"Print results pwreg object","code":""},{"path":[]},{"path":"https://lmaowisc.github.io/WR/reference/print.pwreg.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print the results of the proportional win-fractions regression model — print.pwreg","text":"","code":"# see the example for pwreg"},{"path":"https://lmaowisc.github.io/WR/reference/print.pwreg.score.html","id":null,"dir":"Reference","previous_headings":"","what":"Print information on the content of the pwreg.score object — print.pwreg.score","title":"Print information on the content of the pwreg.score object — print.pwreg.score","text":"Print information content pwreg.score object","code":""},{"path":"https://lmaowisc.github.io/WR/reference/print.pwreg.score.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print information on the content of the pwreg.score object — print.pwreg.score","text":"","code":"# S3 method for class 'pwreg.score' print(x, ...)"},{"path":"https://lmaowisc.github.io/WR/reference/print.pwreg.score.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print information on the content of the pwreg.score object — print.pwreg.score","text":"x object class pwreg.score. ... arguments passed methods.","code":""},{"path":"https://lmaowisc.github.io/WR/reference/print.pwreg.score.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print information on the content of the pwreg.score object — print.pwreg.score","text":"Print results pwreg.score object.","code":""},{"path":[]},{"path":"https://lmaowisc.github.io/WR/reference/print.pwreg.score.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print information on the content of the pwreg.score object — print.pwreg.score","text":"","code":"# see the example for score.proc"},{"path":"https://lmaowisc.github.io/WR/reference/print.pwreg1.html","id":null,"dir":"Reference","previous_headings":"","what":"Print model information for a proportional win-fractions regression — print.pwreg1","title":"Print model information for a proportional win-fractions regression — print.pwreg1","text":"Print model information proportional win-fractions regression.","code":""},{"path":"https://lmaowisc.github.io/WR/reference/print.pwreg1.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print model information for a proportional win-fractions regression — print.pwreg1","text":"","code":"# S3 method for class 'pwreg1' print(x, ...)"},{"path":"https://lmaowisc.github.io/WR/reference/print.pwreg1.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print model information for a proportional win-fractions regression — print.pwreg1","text":"x object class pwreg1. ... arguments passed methods.","code":""},{"path":"https://lmaowisc.github.io/WR/reference/print.pwreg1.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print model information for a proportional win-fractions regression — print.pwreg1","text":"Print results pwreg1 object","code":""},{"path":[]},{"path":"https://lmaowisc.github.io/WR/reference/print.pwreg1.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print model information for a proportional win-fractions regression — print.pwreg1","text":"","code":"# see the example for pwreg1"},{"path":"https://lmaowisc.github.io/WR/reference/pwreg.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit a standard proportional win-fractions (PW) regression model — pwreg","title":"Fit a standard proportional win-fractions (PW) regression model — pwreg","text":"Fit standard proportional win-fractions (PW) regression model.","code":""},{"path":"https://lmaowisc.github.io/WR/reference/pwreg.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit a standard proportional win-fractions (PW) regression model — pwreg","text":"","code":"pwreg(   ID,   time,   status,   Z,   rho = 0,   strata = NULL,   fixedL = TRUE,   eps = 1e-04,   maxiter = 50 )"},{"path":"https://lmaowisc.github.io/WR/reference/pwreg.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit a standard proportional win-fractions (PW) regression model — pwreg","text":"ID vector unique subject-level identifiers. time vector event times. status vector event type labels. 0: censoring, 1:death 2: non-fatal event. Z matrix vector covariates. rho non-negative number power survival function used weight. Default (rho=0) recommended. `strata` argument, `rho` ignored. strata vector stratifying variable stratified model desired. fixedL logical variable indicating variance estimator used. `TRUE`, type variance estimator (small number strata) used; otherwise type II variance estimator (large number strata) used. eps precision convergence Newton-Raphson algorithm. maxiter maximum number iterations allow Newton-Raphson algorithm.","code":""},{"path":"https://lmaowisc.github.io/WR/reference/pwreg.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit a standard proportional win-fractions (PW) regression model — pwreg","text":"object class pwreg following components. beta:vector estimated regression coefficients. Var:estimated covariance matrix beta. conv: boolean variable indicating whether algorithm converged within maximum number iterations.","code":""},{"path":"https://lmaowisc.github.io/WR/reference/pwreg.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Fit a standard proportional win-fractions (PW) regression model — pwreg","text":"Mao, L. Wang, T. (2020). class proportional win-fractions regression models composite outcomes. Biometrics, 10.1111/biom.13382 Wang, T. Mao, L. (2021+). Stratified Proportional Win-fractions Regression Analysis.","code":""},{"path":[]},{"path":"https://lmaowisc.github.io/WR/reference/pwreg.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit a standard proportional win-fractions (PW) regression model — pwreg","text":"","code":"library(WR) head(non_ischemic) #>   ID time status trt_ab age sex Black.vs.White Other.vs.White   bmi bipllvef #> 1  1  221      2      0  62   1              0              0 25.18    32.24 #> 2  1  383      0      0  62   1              0              0 25.18    32.24 #> 3  2   23      2      0  75   1              1              0 22.96    21.71 #> 4  2 1400      0      0  75   1              1              0 22.96    21.71 #> 5  5    7      2      0  48   1              1              0 34.37    22.97 #> 6  5   10      1      0  48   1              1              0 34.37    22.97 #>   hyperten COPD diabetes acei betab smokecurr #> 1        0    0        0    0     1         1 #> 2        0    0        0    0     1         1 #> 3        1    0        0    0     1         0 #> 4        1    0        0    0     1         0 #> 5        1    0        0    0     1         0 #> 6        1    0        0    0     1         0 id_unique <-unique(non_ischemic$ID)  # Randomly sample 200 subjects from non_ischemic data set.seed(2019) id_sample <- sample(id_unique, 200) non_ischemic_reduce <- non_ischemic[non_ischemic$ID %in% id_sample, ]  # Use the reduced non_ischemic data for analysis nr <- nrow(non_ischemic_reduce) p <- ncol(non_ischemic_reduce)-3 ID <- non_ischemic_reduce[,\"ID\"] time <- non_ischemic_reduce[,\"time\"] status <- non_ischemic_reduce[,\"status\"] Z <- as.matrix(non_ischemic_reduce[,4:(3+p)],nr,p) ## unstratified analysis pwreg.obj <- pwreg(time=time,status=status,Z=Z,ID=ID) print(pwreg.obj) #> Call: #> pwreg(ID = ID, time = time, status = status, Z = Z) #>  #> Proportional win-fractions regression models for priority-adjusted composite endpoint #>  #>     (Mao and Wang, 2020): #>  #> Total number of pairs: 19900  #> Wins-losses on death:  1306 (6.6%)  #> Wins-losses on non-fatal event:  15345 (77.1%)  #> Indeterminate pairs 3249 (16.3%)  #>  #> Newton-Raphson algorithm converged in 5 iterations. #>  #> Overall test: chisq test with 13 degrees of freedom;  #>  Wald statistic 25.1 with p-value 0.02230495  #>  #> Estimates for Regression parameters: #>                  Estimate         se z.value p.value   #> trt_ab          0.1897070  0.2017570  0.9403 0.34708   #> age            -0.0107734  0.0087005 -1.2383 0.21562   #> sex            -0.4367173  0.2053482 -2.1267 0.03344 * #> Black.vs.White -0.1674782  0.2262604 -0.7402 0.45918   #> Other.vs.White -0.3121187  0.7777347 -0.4013 0.68819   #> bmi            -0.0352119  0.0158922 -2.2157 0.02671 * #> bipllvef        0.0273218  0.0123319  2.2155 0.02672 * #> hyperten       -0.3656759  0.2391985 -1.5288 0.12633   #> COPD           -0.3244369  0.3315767 -0.9785 0.32784   #> diabetes        0.0348824  0.2128076  0.1639 0.86980   #> acei           -0.2307814  0.2835244 -0.8140 0.41566   #> betab          -0.2781857  0.4866345 -0.5717 0.56756   #> smokecurr       0.0002984  0.2631628  0.0011 0.99910   #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #>  #> Point and interval estimates for the win ratios: #>                Win Ratio 95% lower CL 95% higher CL #> trt_ab         1.2088953    0.8140532     1.7952486 #> age            0.9892844    0.9725575     1.0062990 #> sex            0.6461541    0.4320593     0.9663374 #> Black.vs.White 0.8457951    0.5428401     1.3178269 #> Other.vs.White 0.7318946    0.1593821     3.3609149 #> bmi            0.9654009    0.9357939     0.9959445 #> bipllvef       1.0276985    1.0031568     1.0528406 #> hyperten       0.6937276    0.4340930     1.1086516 #> COPD           0.7229343    0.3774507     1.3846417 #> diabetes       1.0354980    0.6823498     1.5714169 #> acei           0.7939130    0.4554456     1.3839147 #> betab          0.7571562    0.2917168     1.9652127 #> smokecurr      1.0002984    0.5972072     1.6754604 #>  if (FALSE) { # \\dontrun{ ## stratified PW by sex sex<-Z[,3] ## take out sex from the covariate matrix Z1<-Z[,-3] pwreg.obj1 <- pwreg(time=time,status=status,Z=Z1,ID=ID,strata=sex) print(pwreg.obj1) } # }"},{"path":"https://lmaowisc.github.io/WR/reference/pwreg1.html","id":null,"dir":"Reference","previous_headings":"","what":"A test version of pwreg — pwreg1","title":"A test version of pwreg — pwreg1","text":"function test version pwreg function. intended simplify code make computations efficient.","code":""},{"path":"https://lmaowisc.github.io/WR/reference/pwreg1.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A test version of pwreg — pwreg1","text":"","code":"pwreg1(   id,   time,   status,   Z,   wfun = NULL,   Y = NULL,   strata = NULL,   fixedL = TRUE,   eps = 1e-06,   maxiter = 50 )"},{"path":"https://lmaowisc.github.io/WR/reference/pwreg1.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A test version of pwreg — pwreg1","text":"id vector subject identifiers. time vector event times. status vector event indicators. Z matrix data frame (tibble) covariates. wfun function win function (Default standard Pocock's win function). Y optional matrix data frame (tibble) continuous response variables. strata vector strata indicators. fixedL logical value indicating whether frailty variance fixed. eps numeric value convergence criterion. maxiter numeric value maximum number iterations.","code":""},{"path":"https://lmaowisc.github.io/WR/reference/score.proc.html","id":null,"dir":"Reference","previous_headings":"","what":"Computes the standardized score processes — score.proc","title":"Computes the standardized score processes — score.proc","text":"Computes standarized score processes covariates.","code":""},{"path":"https://lmaowisc.github.io/WR/reference/score.proc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Computes the standardized score processes — score.proc","text":"","code":"score.proc(obj, t = NULL)"},{"path":"https://lmaowisc.github.io/WR/reference/score.proc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Computes the standardized score processes — score.proc","text":"obj object class pwreg. t vector containing times. specified, function use unique event times data.","code":""},{"path":"https://lmaowisc.github.io/WR/reference/score.proc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Computes the standardized score processes — score.proc","text":"object class pwreg.score consisting t: vector times; score: matrix whose rows standardized score processes function t.","code":""},{"path":"https://lmaowisc.github.io/WR/reference/score.proc.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Computes the standardized score processes — score.proc","text":"Mao, L. Wang, T. (2020). class proportional win-fractions regression models composite outcomes. Biometrics, 10.1111/biom.13382","code":""},{"path":[]},{"path":"https://lmaowisc.github.io/WR/reference/score.proc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Computes the standardized score processes — score.proc","text":"","code":"library(WR) head(non_ischemic) #>   ID time status trt_ab age sex Black.vs.White Other.vs.White   bmi bipllvef #> 1  1  221      2      0  62   1              0              0 25.18    32.24 #> 2  1  383      0      0  62   1              0              0 25.18    32.24 #> 3  2   23      2      0  75   1              1              0 22.96    21.71 #> 4  2 1400      0      0  75   1              1              0 22.96    21.71 #> 5  5    7      2      0  48   1              1              0 34.37    22.97 #> 6  5   10      1      0  48   1              1              0 34.37    22.97 #>   hyperten COPD diabetes acei betab smokecurr #> 1        0    0        0    0     1         1 #> 2        0    0        0    0     1         1 #> 3        1    0        0    0     1         0 #> 4        1    0        0    0     1         0 #> 5        1    0        0    0     1         0 #> 6        1    0        0    0     1         0  # Randomly sample 200 subjects from non_ischemic data id_unique <-unique(non_ischemic$ID) set.seed(2019) id_sample <- sample(id_unique, 200) non_ischemic_reduce <- non_ischemic[non_ischemic$ID %in% id_sample, ]  # Use the reduced non_ischemic data for analysis nr <- nrow(non_ischemic_reduce) p <- ncol(non_ischemic_reduce)-3 ID <- non_ischemic_reduce[,\"ID\"] time <- non_ischemic_reduce[,\"time\"] status <- non_ischemic_reduce[,\"status\"] Z <- as.matrix(non_ischemic_reduce[,4:(3+p)],nr,p) pwreg.obj <- pwreg(time=time,status=status,Z=Z,ID=ID) score.obj <- score.proc(pwreg.obj) #plot the standardized score process for the first covariate plot(score.obj, k = 1)"}]
